各个阶段的详细代码请见分支。。。。
